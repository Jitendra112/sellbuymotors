<%- include ../sellbuylayouts/header.ejs %>
<!-- End Header-->        <!-- Page Inner-->
  <style>
      #loading{
        position: fixed;
        z-index: 99;
    }
  </style>
        <section>
            <div class="background-image-maker gradient gradient-lr"></div>
            <div class="holder-image">
                <img src="images/bg2.jpg" alt="" class="img-fluid d-none" />
            </div>
            <div class="black-overlay overlay-full"></div>
            <div class="container">
                <div class="row">
                    <div class="col-12 col-sm-12 justify-content-center text-center">
                        <h1 class="text-white c-font-weight-700">Add Car</h1>
                    </div>
                </div>
            </div>
        </section>
        <!-- End Page Inner-->
        
        <!-- Breadcrumb -->
        <section class="py-0 h-0">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-10 col-sm-5 col-lg-3 text-center">
                        <ol class="breadcrumb justify-content-center mb-0 c-bg-primary text-white py-3 position-relative">
                            <li class="breadcrumb-item"><a href="#">Home</a></li>
                            <li class="breadcrumb-item active">Add Car</li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>
        <!-- End Breadcrumb -->
        
        <!-- Sell Car -->
        <section>
            <div class="container">
                <div class="row">
                    <div class="col-12 col-xl-5 mb-5 mb-xl-0 align-self-center">
                        <h1 class="c-font-weight-300 c-line-height-1_2"> Sell your used car at <span class="c-primary c-font-weight-700">Guaranteed</span> best price</h1>
                        <ul class="list-unstyled service-list text-white mb-0">
                            <li class="list-one mb-3">
                                <div class="media d-block d-sm-flex c-bg-primary p-3 p-sm-2 text-center text-sm-left">
                                    <h2 class="rounded-circle bg-white list-icon d-sm-flex mr-sm-4 mb-0 text-center mx-auto mb-3 mb-sm-0"><span class="lnr lnr-magic-wand"></span></h2>
                                    <div class="media-body align-self-center">
                                        <h5 class="mb-1 text-white">It's all Free!</h5>
                                        Cras ultricies mi eu turpis
                                    </div>
                                </div>
                            </li>
                            <li class="list-two mb-3">
                                <div class="media d-block d-sm-flex c-bg-primary p-3 p-sm-2 text-center text-sm-left">
                                    <h2 class="rounded-circle bg-white list-icon d-sm-flex mr-sm-4 mb-0 text-center mx-auto mb-3 mb-sm-0"><span class="lnr lnr-users"></span></h2>
                                    <div class="media-body align-self-center">
                                        <h5 class="mb-1 text-white">Genuie Buyers</h5>
                                        Cras ultricies mi eu turpis
                                    </div>
                                </div>
                            </li>
                            <li class="list-three">
                                <div class="media d-block d-sm-flex c-bg-primary p-3 p-sm-2 text-center text-sm-left">
                                    <h2 class="rounded-circle bg-white list-icon d-sm-flex mr-sm-4 mb-0 text-center mx-auto mb-3 mb-sm-0"><span class="lnr lnr-alarm"></span></h2>
                                    <div class="media-body align-self-center">
                                        <h5 class="mb-1 text-white">Instant Notifications</h5>
                                        Cras ultricies mi eu turpis
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="col-12 col-xl-6 ml-auto text-center text-xl-right">
                        <img src="images/sell-car.png" alt="" class="img-fluid" />
                    </div> 
                </div>
            </div>
        </section>
        <!-- End Sell Car -->
        
        <!-- Post Ad -->
        <section class="pt-0">
            <div class="container">
                <div class="row">
                    <div class="col-12 col-sm-7">
                        <h3>Post Your Ad</h3>
                        <p>Phasellus viverra nulla ut metus varius laoreet. Quisque rutrum. Aenean imperdiet. Etiam ultricies nisi vel augue. Curabitur ullamcorper ultricies nisi.</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-sm-12">
                        <div class="card c-brd-light condition">
                            <div class="card-body">
                                <div class="row">
                                    <!-- <div class="col-12 col-sm-4">
                                        <label class="c-dark">Cover Photo</label>
                                        <div class="form-group">
                                            <input type="file" class="choose form-control" />
                                        </div>
                                    </div>  -->
                                    <div class="col-12 col-sm-12"  id="link">
                                        <label class="c-dark">Gallery</label>
                                        <div class="form-group text-center">
                                        <form action="/uploads" id="uploadform"  enctype="multipart/form-data"  method="POST">
                                                <div class="d-table w-100 h-100 ">
                                                    <div class="d-table-cell align-middle">
                                                        <div class="dz-default dz-message" id="mydiv">
                                                          
                                                        </div>
                                                    </div>
                                                </div>
                                            
                                        </div>
                                        <div class="grid row" id="grid">
                                         
                                            


                                        </div>
                                       
                                    </div> 

                                    <div class="col-12 col-sm-4 col-lg-2 mr-auto mt-3 mt-sm-0">
                                        <a href="/sellcar" class="btn btn-secondary btn-md btn-block text-uppercase">Back</a>

                                    </div>
                                     <div class="col-12 col-md-5 col-xl-6 align-self-center" id="loading" style="display:none;top: 70%;right: 33%;">
                                    <img src="/images/preloader.gif" style="height:100% ;width:100%"/>
                                    </div>
                                     </form>
                                    <div class="col-12 col-sm-4 col-lg-2 ml-auto mt-3 mt-sm-0" id="public">
                                        <a href="/mycars" class="btn btn-primary btn-md btn-block text-uppercase">Public Listing</a>  
                                    </div>
                                   
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- End Post Ad -->
<%- include ../sellbuylayouts/footer.ejs %>          
<script src="/js/jquery-3.3.1.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.0.1/js/toastr.js"></script>
<script>
    var html ='';
    var myvar;
    function GetParameterValues(car_id) {
        var url = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        //console.log(url)
        for (var i = 0; i < url.length; i++) {
            var urlparam = url[i].split('=');
           // console.log(urlparam[1])
             myvar = urlparam[1];
        }

          html+='<input type="file" name="userPhoto" class="custom-file-input" onchange="mySubmit(this.form)" id="file_id">';
          html+='<input type="hidden" name="carid" value="' + urlparam[1] + '"/>';
          html+='<h5 class="mb-2 c-light"><i class="fa fa-plus"></i></h5>';
          html+='<span id="myspan"> Add Photo</span>';
         $('#mydiv').html(html);




    }
    GetParameterValues();
 </script> 
 <script>
  function mySubmit(theForm) {
        $('#uploadform').submit();

    }

  $(document).on('submit','#uploadform' ,function(e) {
      $('#loading').css('display', 'block')
       e.preventDefault();
        var formData = new FormData(this);  
       // alert(formData);
        console.log(formData)                
        $.ajax({
        type:'POST',
        url:$(this).attr('action'),
        data:formData,
        cashe:false,
        contentType:false,
        processData:false,                      
        success:function(data){
         $('#loading').css('display', 'none')
         if(data.success == 1){

           toastr.success(data.message)
            get_images()
         
         }else{

           toastr.error(data.message)
           location.reload();

         }

      },
       
        },'json');
     
});
get_images()
function get_images(){

 
// alert(myvar);
  var html = '';
  $.get('/get_images?id='+ myvar ,function(res){
       console.log(res.image);
    $.each(res,function(key,val){
      html += '<div class="col-md-3" id="image_get"><img src="/uploads/'+ val.image_name + '" height="100px" width="100px"></div>'
    })
      $('#grid').html(html)
  },'json')
}



</script>